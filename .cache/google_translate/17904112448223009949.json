There is a very good book on this.