There are too many places where the logic is wrong.