The task was much more complicated than I thought.