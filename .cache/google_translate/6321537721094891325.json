But the ending was a mess.